"use strict";(function(){var c=function(){};c._collectorIframe="logo.htm";c._collectorImg="logo.gif";c._collectorId=12345;c._sandboxCollectorId=6789;c._deviceDataId=undefined;function e(){if(c._deviceDataId===undefined){c._deviceDataId=a.codec.base64.fromBits(a.random.randomWords(6,0))}return c._deviceDataId}function b(h,g,f){setTimeout(function(){if(document.getElementById(f)){return}var j=document.createElement("iframe");j.id=f;j.width=1;j.height=1;j.frameBorder=0;j.scrolling="no";j.src=h;document.body.appendChild(j);var i=document.createElement("img");i.src=g;i.width=1;i.height=1;j.appendChild(i)},50)}function d(){var g="?m="+(OpenPay.sandboxMode?c._sandboxCollectorId:c._collectorId)+"&s="+encodeURIComponent(e());var f=(OpenPay.sandboxMode?OpenPay.sandboxHostname:OpenPay.hostname);var h=f+c._collectorImg+g;var i=f+c._collectorIframe+g;b(i,h,"_op_data_r");return e()}c.setup=function(g,h){if(g){var f=document.getElementById(g).appendChild(document.createElement("input"));f.type="hidden";f.value=e();f.name=h?h:"deviceDataId";f.id=h?h:"deviceDataId"}return d()};OpenPay.deviceData=c;var a={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(f){this.toString=function(){return"CORRUPT: "+this.message};this.message=f},invalid:function(f){this.toString=function(){return"INVALID: "+this.message};this.message=f},bug:function(f){this.toString=function(){return"BUG: "+this.message};this.message=f},notReady:function(f){this.toString=function(){return"NOT READY: "+this.message};this.message=f}}};if(typeof module!=="undefined"&&module.exports){module.exports=a}a.cipher.aes=function(o){if(!this._tables[0][0][0]){this._precompute()}var k,h,l,n,q,m=this._tables[0][4],p=this._tables[1],f=o.length,g=1;if(f!==4&&f!==6&&f!==8){throw new a.exception.invalid("invalid aes key size")}this._key=[n=o.slice(0),q=[]];for(k=f;k<4*f+28;k++){l=n[k-1];if(k%f===0||f===8&&k%f===4){l=m[l>>>24]<<24^m[l>>16&255]<<16^m[l>>8&255]<<8^m[l&255];if(k%f===0){l=l<<8^l>>>24^g<<24;g=g<<1^(g>>7)*283}}n[k]=n[k-f]^l}for(h=0;k;h++,k--){l=n[h&3?k:k-4];if(k<=4||h<4){q[h]=l}else{q[h]=p[0][m[l>>>24]]^p[1][m[l>>16&255]]^p[2][m[l>>8&255]]^p[3][m[l&255]]}}};a.cipher.aes.prototype={encrypt:function(f){return this._crypt(f,0)},decrypt:function(f){return this._crypt(f,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var n=this._tables[0],v=this._tables[1],m=n[4],r=v[4],l,p,k,o=[],h=[],g,u,q,t,j,f;for(l=0;l<256;l++){h[(o[l]=l<<1^(l>>7)*283)^l]=l}for(p=k=0;!m[p];p^=g||1,k=h[k]||1){t=k^k<<1^k<<2^k<<3^k<<4;t=t>>8^t&255^99;m[p]=t;r[t]=p;q=o[u=o[g=o[p]]];f=q*16843009^u*65537^g*257^p*16843008;j=o[t]*257^t*16843008;for(l=0;l<4;l++){n[l][p]=j=j<<24^j>>>8;v[l][t]=f=f<<24^f>>>8}}for(l=0;l<5;l++){n[l]=n[l].slice(0);v[l]=v[l].slice(0)}},_crypt:function(l,o){if(l.length!==4){throw new a.exception.invalid("invalid aes block size")}var z=this._key[o],w=l[0]^z[0],v=l[o?3:1]^z[1],u=l[2]^z[2],t=l[o?1:3]^z[3],x,f,n,y=z.length/4-2,q,p=4,r=[0,0,0,0],s=this._tables[o],k=s[0],j=s[1],h=s[2],g=s[3],m=s[4];for(q=0;q<y;q++){x=k[w>>>24]^j[v>>16&255]^h[u>>8&255]^g[t&255]^z[p];f=k[v>>>24]^j[u>>16&255]^h[t>>8&255]^g[w&255]^z[p+1];n=k[u>>>24]^j[t>>16&255]^h[w>>8&255]^g[v&255]^z[p+2];t=k[t>>>24]^j[w>>16&255]^h[v>>8&255]^g[u&255]^z[p+3];p+=4;w=x;v=f;u=n}for(q=0;q<4;q++){r[o?3&-q:q]=m[w>>>24]<<24^m[v>>16&255]<<16^m[u>>8&255]<<8^m[t&255]^z[p++];x=w;w=v;v=u;u=t;t=x}return r}};a.bitArray={bitSlice:function(f,g,h){f=a.bitArray._shiftRight(f.slice(g/32),32-(g&31)).slice(1);return h===undefined?f:a.bitArray.clamp(f,h-g)},extract:function(g,h,j){var f,i=Math.floor(-h-j&31);if((h+j-1^h)&-32){f=g[h/32|0]<<32-i^g[h/32+1|0]>>>i}else{f=g[h/32|0]>>>i}return f&(1<<j)-1},concat:function(h,f){if(h.length===0||f.length===0){return h.concat(f)}var j,k,l=h[h.length-1],g=a.bitArray.getPartial(l);if(g===32){return h.concat(f)}else{return a.bitArray._shiftRight(f,g,l|0,h.slice(0,h.length-1))}},bitLength:function(h){var g=h.length,f;if(g===0){return 0}f=h[g-1];return(g-1)*32+a.bitArray.getPartial(f)},clamp:function(h,f){if(h.length*32<f){return h}h=h.slice(0,Math.ceil(f/32));var g=h.length;f=f&31;if(g>0&&f){h[g-1]=a.bitArray.partial(f,h[g-1]&2147483648>>f-1,1)}return h},partial:function(g,f,h){if(g===32){return f}return(h?f|0:f<<32-g)+g*1099511627776},getPartial:function(f){return Math.round(f/1099511627776)||32},equal:function(h,g){if(a.bitArray.bitLength(h)!==a.bitArray.bitLength(g)){return false}var f=0,j;for(j=0;j<h.length;j++){f|=h[j]^g[j]}return f===0},_shiftRight:function(h,g,m,k){var l,f=0,j;if(k===undefined){k=[]}for(;g>=32;g-=32){k.push(m);m=0}if(g===0){return k.concat(h)}for(l=0;l<h.length;l++){k.push(m|h[l]>>>g);m=h[l]<<32-g}f=h.length?h[h.length-1]:0;j=a.bitArray.getPartial(f);k.push(a.bitArray.partial(g+j&31,g+j>32?m:k.pop(),1));return k},_xor4:function(f,g){return[f[0]^g[0],f[1]^g[1],f[2]^g[2],f[3]^g[3]]}};a.codec.utf8String={fromBits:function(f){var g="",k=a.bitArray.bitLength(f),j,h;for(j=0;j<k/8;j++){if((j&3)===0){h=f[j/4]}g+=String.fromCharCode(h>>>24);h<<=8}return decodeURIComponent(escape(g))},toBits:function(j){j=unescape(encodeURIComponent(j));var f=[],h,g=0;for(h=0;h<j.length;h++){g=g<<8|j.charCodeAt(h);if((h&3)===3){f.push(g);g=0}}if(h&3){f.push(a.bitArray.partial(8*(h&3),g))}return f}};a.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(l,o,g){var h="",j,n=0,m=a.codec.base64._chars,k=0,f=a.bitArray.bitLength(l);if(g){m=m.substr(0,62)+"-_"}for(j=0;h.length*6<f;){h+=m.charAt((k^l[j]>>>n)>>>26);if(n<6){k=l[j]<<6-n;n+=26;j++}else{k<<=6;n-=6}}while(h.length&3&&!o){h+="="}return h},toBits:function(m,k){m=m.replace(/\s|=/g,"");var h=[],j,l=0,n=a.codec.base64._chars,g=0,f;if(k){n=n.substr(0,62)+"-_"}for(j=0;j<m.length;j++){f=n.indexOf(m.charAt(j));if(f<0){throw new a.exception.invalid("this isn't base64!")}if(l>26){l-=26;h.push(g^f>>>l);g=f<<32-l}else{l+=6;g^=f<<32-l}}if(l&56){h.push(a.bitArray.partial(l&56,g,1))}return h}};a.codec.base64url={fromBits:function(f){return a.codec.base64.fromBits(f,1,1)},toBits:function(f){return a.codec.base64.toBits(f,1)}};a.hash.sha256=function(f){if(!this._key[0]){this._precompute()}if(f){this._h=f._h.slice(0);this._buffer=f._buffer.slice(0);this._length=f._length}else{this.reset()}};a.hash.sha256.hash=function(f){return(new a.hash.sha256).update(f).finalize()};a.hash.sha256.prototype={blockSize:512,reset:function(){this._h=this._init.slice(0);this._buffer=[];this._length=0;return this},update:function(k){if(typeof k==="string"){k=a.codec.utf8String.toBits(k)}var j,f=this._buffer=a.bitArray.concat(this._buffer,k),h=this._length,g=this._length=h+a.bitArray.bitLength(k);for(j=512+h&-512;j<=g;j+=512){this._block(f.splice(0,16))}return this},finalize:function(){var g,f=this._buffer,j=this._h;f=a.bitArray.concat(f,[a.bitArray.partial(1,1)]);for(g=f.length+2;g&15;g++){f.push(0)}f.push(Math.floor(this._length/4294967296));f.push(this._length|0);while(f.length){this._block(f.splice(0,16))}this.reset();return j},_init:[],_key:[],_precompute:function(){var j=0,h=2,g;function f(i){return(i-Math.floor(i))*4294967296|0}outer:for(;j<64;h++){for(g=2;g*g<=h;g++){if(h%g===0){continue outer}}if(j<8){this._init[j]=f(Math.pow(h,1/2))}this._key[j]=f(Math.pow(h,1/3));j++}},_block:function(t){var j,l,x,v,y=t.slice(0),n=this._h,f=this._key,u=n[0],s=n[1],r=n[2],q=n[3],p=n[4],o=n[5],m=n[6],g=n[7];for(j=0;j<64;j++){if(j<16){l=y[j]}else{x=y[j+1&15];v=y[j+14&15];l=y[j&15]=(x>>>7^x>>>18^x>>>3^x<<25^x<<14)+(v>>>17^v>>>19^v>>>10^v<<15^v<<13)+y[j&15]+y[j+9&15]|0}l=l+g+(p>>>6^p>>>11^p>>>25^p<<26^p<<21^p<<7)+(m^p&(o^m))+f[j];g=m;m=o;o=p;p=q+l|0;q=r;r=s;s=u;u=l+(s&r^q&(s^r))+(s>>>2^s>>>13^s>>>22^s<<30^s<<19^s<<10)|0}n[0]=n[0]+u|0;n[1]=n[1]+s|0;n[2]=n[2]+r|0;n[3]=n[3]+q|0;n[4]=n[4]+p|0;n[5]=n[5]+o|0;n[6]=n[6]+m|0;n[7]=n[7]+g|0}};a.prng=function(f){this._pools=[new a.hash.sha256];this._poolEntropy=[0];this._reseedCount=0;this._robins={};this._eventId=0;this._collectorIds={};this._collectorIdNext=0;this._strength=0;this._poolStrength=0;this._nextReseed=0;this._key=[0,0,0,0,0,0,0,0];this._counter=[0,0,0,0];this._cipher=undefined;this._defaultParanoia=f;this._collectorsStarted=false;this._callbacks={progress:{},seeded:{}};this._callbackI=0;this._NOT_READY=0;this._READY=1;this._REQUIRES_RESEED=2;this._MAX_WORDS_PER_BURST=65536;this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024];this._MILLISECONDS_PER_RESEED=30000;this._BITS_PER_RESEED=80};a.prng.prototype={randomWords:function(f,m){var h=[],k,j=this.isReady(m),l;if(j===this._NOT_READY){throw new a.exception.notReady("generator isn't seeded")}else{if(j&this._REQUIRES_RESEED){this._reseedFromPools(!(j&this._READY))}}for(k=0;k<f;k+=4){if((k+1)%this._MAX_WORDS_PER_BURST===0){this._gate()}l=this._gen4words();h.push(l[0],l[1],l[2],l[3])}this._gate();return h.slice(0,f)},setDefaultParanoia:function(g,f){if(g===0&&f!=="Setting paranoia=0 will ruin your security; use it only for testing"){throw"Setting paranoia=0 will ruin your security; use it only for testing"}this._defaultParanoia=g},addEntropy:function(k,q,f){f=f||"user";var g,l,m,o=(new Date).valueOf(),h=this._robins[f],p=this.isReady(),j=0,n;g=this._collectorIds[f];if(g===undefined){g=this._collectorIds[f]=this._collectorIdNext++}if(h===undefined){h=this._robins[f]=0}this._robins[f]=(this._robins[f]+1)%this._pools.length;switch(typeof k){case"number":if(q===undefined){q=1}this._pools[h].update([g,this._eventId++,1,q,o,1,k|0]);break;case"object":n=Object.prototype.toString.call(k);if(n==="[object Uint32Array]"){m=[];for(l=0;l<k.length;l++){m.push(k[l])}k=m}else{if(n!=="[object Array]"){j=1}for(l=0;l<k.length&&!j;l++){if(typeof k[l]!=="number"){j=1}}}if(!j){if(q===undefined){q=0;for(l=0;l<k.length;l++){m=k[l];while(m>0){q++;m=m>>>1}}}this._pools[h].update([g,this._eventId++,2,q,o,k.length].concat(k))}break;case"string":if(q===undefined){q=k.length}this._pools[h].update([g,this._eventId++,3,q,o,k.length]);this._pools[h].update(k);break;default:j=1}if(j){throw new a.exception.bug("random: addEntropy only supports number, array of numbers or string")}this._poolEntropy[h]+=q;this._poolStrength+=q;if(p===this._NOT_READY){if(this.isReady()!==this._NOT_READY){this._fireEvent("seeded",Math.max(this._strength,this._poolStrength))}this._fireEvent("progress",this.getProgress())}},isReady:function(g){var f=this._PARANOIA_LEVELS[g!==undefined?g:this._defaultParanoia];if(this._strength&&this._strength>=f){return this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY}else{return this._poolStrength>=f?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY}},getProgress:function(g){var f=this._PARANOIA_LEVELS[g?g:this._defaultParanoia];if(this._strength>=f){return 1}else{return this._poolStrength>f?1:this._poolStrength/f}},startCollectors:function(){if(this._collectorsStarted){return}this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector)};if(window.addEventListener){window.addEventListener("load",this._eventListener.loadTimeCollector,false);window.addEventListener("mousemove",this._eventListener.mouseCollector,false);window.addEventListener("keypress",this._eventListener.keyboardCollector,false);window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,false)}else{if(document.attachEvent){document.attachEvent("onload",this._eventListener.loadTimeCollector);document.attachEvent("onmousemove",this._eventListener.mouseCollector);document.attachEvent("keypress",this._eventListener.keyboardCollector)}else{throw new a.exception.bug("can't attach event")}}this._collectorsStarted=true},stopCollectors:function(){if(!this._collectorsStarted){return}if(window.removeEventListener){window.removeEventListener("load",this._eventListener.loadTimeCollector,false);window.removeEventListener("mousemove",this._eventListener.mouseCollector,false);window.removeEventListener("keypress",this._eventListener.keyboardCollector,false);window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,false)}else{if(document.detachEvent){document.detachEvent("onload",this._eventListener.loadTimeCollector);document.detachEvent("onmousemove",this._eventListener.mouseCollector);document.detachEvent("keypress",this._eventListener.keyboardCollector)}}this._collectorsStarted=false},addEventListener:function(f,g){this._callbacks[f][this._callbackI++]=g},removeEventListener:function(l,f){var m,k,h=this._callbacks[l],g=[];for(k in h){if(h.hasOwnProperty(k)&&h[k]===f){g.push(k)}}for(m=0;m<g.length;m++){k=g[m];delete h[k]}},_bind:function(g){var f=this;return function(){g.apply(f,arguments)}},_gen4words:function(){for(var f=0;f<4;f++){this._counter[f]=this._counter[f]+1|0;if(this._counter[f]){break}}return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words());this._cipher=new a.cipher.aes(this._key)},_reseed:function(g){this._key=a.hash.sha256.hash(this._key.concat(g));this._cipher=new a.cipher.aes(this._key);for(var f=0;f<4;f++){this._counter[f]=this._counter[f]+1|0;if(this._counter[f]){break}}},_reseedFromPools:function(h){var f=[],j=0,g;this._nextReseed=f[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED;for(g=0;g<16;g++){f.push(Math.random()*4294967296|0)}for(g=0;g<this._pools.length;g++){f=f.concat(this._pools[g].finalize());j+=this._poolEntropy[g];this._poolEntropy[g]=0;if(!h&&this._reseedCount&1<<g){break}}if(this._reseedCount>=1<<this._pools.length){this._pools.push(new a.hash.sha256);this._poolEntropy.push(0)}this._poolStrength-=j;if(j>this._strength){this._strength=j}this._reseedCount++;this._reseed(f)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(g){var f=g.x||g.clientX||g.offsetX||0,h=g.y||g.clientY||g.offsetY||0;a.random.addEntropy([f,h],2,"mouse");this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(f){if(window&&window.performance&&typeof window.performance.now==="function"){a.random.addEntropy(window.performance.now(),f,"loadtime")}else{a.random.addEntropy((new Date).valueOf(),f,"loadtime")}},_accelerometerCollector:function(g){var f=g.accelerationIncludingGravity.x||g.accelerationIncludingGravity.y||g.accelerationIncludingGravity.z;if(window.orientation){var h=window.orientation;if(typeof h==="number"){a.random.addEntropy(h,1,"accelerometer")}}if(f){a.random.addEntropy(f,2,"accelerometer")}this._addCurrentTimeToEntropy(0)},_fireEvent:function(i,f){var h,g=a.random._callbacks[i],k=[];for(h in g){if(g.hasOwnProperty(h)){k.push(g[h])}}for(h=0;h<k.length;h++){k[h](f)}}};a.random=new a.prng(6);(function(){try{var g,i,f,h;if(typeof module!=="undefined"&&module.exports&&(i=require("crypto"))&&i.randomBytes){g=i.randomBytes(1024/8);g=new Uint32Array((new Uint8Array(g)).buffer);a.random.addEntropy(g,1024,"crypto.randomBytes")}else{if(window&&Uint32Array){h=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues){window.crypto.getRandomValues(h)}else{if(window.msCrypto&&window.msCrypto.getRandomValues){window.msCrypto.getRandomValues(h)}else{return}}a.random.addEntropy(h,1024,"crypto.getRandomValues")}else{}}}catch(j){console.log("There was an error collecting entropy from the browser:");console.log(j)}})()}).call(this);