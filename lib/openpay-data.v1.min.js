(function(){function t(){return void 0===o._deviceDataId&&(o._deviceDataId=s.codec.base64.fromBits(s.random.randomWords(6,0)).replace(/[\+\/]/g,"0")),o._deviceDataId}function e(t,e,n){xmlhttp=new XMLHttpRequest,xmlhttp.onreadystatechange=function(){4==xmlhttp.readyState&&200==xmlhttp.status&&document.body.insertAdjacentHTML("beforeend",xmlhttp.responseText)},xmlhttp.open("GET",t+"antifraud/"+e+"/components?s="+n,!0),xmlhttp.send()}function n(){var n,r=t();n=OpenPay.developMode?o._developHostname:OpenPay.sandboxMode?o._sandboxHostname:o._hostname;var i=OpenPay.getId();return e(n,i,r),t()}var o=function(){},r=function(){},i=function(){};o._hostname="https://api.openpay.mx/",o._sandboxHostname="https://sandbox-api.openpay.mx/",o._developHostname="https://dev-api.openpay.mx/",o._deviceDataId=void 0,o.setup=function(e,r){var i=t();if(e&&document.getElementById(e)){var s=document.createElement("input");s.setAttribute("type","hidden"),s.value=i,s.name=r?r:"deviceDataId",s.id=r?r:"deviceDataId",document.getElementById(e).appendChild(s)}var a=!0;try{OpenPay.getId(),OpenPay.getApiKey()}catch(t){a=!1}if(a){console.log("executing sift mode");var c,h=OpenPay.getId(),l=OpenPay.getApiKey();c=OpenPay.developMode?o._developHostname:OpenPay.sandboxMode?o._sandboxHostname:o._hostname;var d=c+"v1/"+h+"/antifraudkeys";try{OpenPay.getBeaconKey.beaconKey(d,l,"",i,c)}catch(t){console.log("continue without beaconkey"+t)}}return n()},i.beaconKey=function(t,e,n,o,r){function i(t,e,n){clearTimeout(l);var o=null;t=t||"Unknown error",e=e||0,n=n||"{}";try{o=JSON.parse(n)}catch(e){t="Response error"}}function s(){if(a(window,"XMLHttpRequest"))return new XMLHttpRequest}function a(t,e){var n=typeof t[e];return"function"==n||!("object"!=n||!t[e])||"unknown"==n}function c(){if("undefined"!=typeof h.readyState&&4==h.readyState||!y)if(clearTimeout(l),h.status<200||h.status>=300)i("Request error NO IE",h.status,h.responseText);else try{var t=h.responseText;t=t.replace("(",""),t=t.replace(")","");var e=JSON.parse(t),s=e.data;console.log("beaconKey ok"),s.length>0?OpenPay.deviceDataSC.setupSC(n,o,s,r):console.log("Empty beaconKey normal in Sandbox")}catch(t){i("Response error (Unknown final status) NO IE",h.status,"{}")}}var h=null,l=null,d=t,u={},p=0,_=btoa(e+":"),f={};if("undefined"==typeof JSON)return void i("Browser error (JSON library not found)");p=4e4;var y=XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;if(y){if(!(h=s()))return void i("Browser error (CORS not supported)");u={Accept:"application/json","Content-Type":"application/json",Authorization:"Basic "+_},h.open("GET",d,!0),"withCredentials"in h&&(h.withCredentials=!0);for(var m in u)u.hasOwnProperty(m)&&u[m]&&"setRequestHeader"in h&&h.setRequestHeader(m,u[m]);"onreadystatechange"in h?h.onreadystatechange=c:"onload"in h&&"onerror"in h&&(h.onload=c,h.onerror=i),l=setTimeout(function(){"onload"in h?h.onload=Function.prototype:h.onreadystatechange=Function.prototype,h.abort(),h=null,i("Timeout after "+p+" milliseconds")},p),h.send()}else{if("undefined"==typeof XDomainRequest)return void i("Browser error (CORS not supported)");f.apiKey=_;var v=function(t){if(t.error)i("Request error",t.httpStatus,JSON.stringify(t));else try{var e=t.data;console.log("beaconKey ok"),e.length>0?OpenPay.deviceDataSC.setupSC(n,o,e,r):console.log("Empty beaconKey normal in Sandbox")}catch(t){i("Response error (Unknown final status)",h.status,"{}")}},g={callbackName:"getResultData",onSuccess:v,onError:i,timeout:p,url:d+"/jsonp",data:f};$jsonp.send(g)}},r.setupSC=function(t,e,n,o){console.log("Sift Snippet");var r=window._sift=window._sift||[];r.push(["_setAccount",n]),r.push(["_setSessionId",e]),r.push(["_trackPageview"]);var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=o+"antifraud/sc.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(i,s)},OpenPay.deviceData=o,OpenPay.getBeaconKey=i,OpenPay.deviceDataSC=r;var s={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};"undefined"!=typeof module&&module.exports&&(module.exports=s),s.cipher.aes=function(t){this._tables[0][0][0]||this._precompute();var e,n,o,r,i,a=this._tables[0][4],c=this._tables[1],h=t.length,l=1;if(4!==h&&6!==h&&8!==h)throw new s.exception.invalid("invalid aes key size");for(this._key=[r=t.slice(0),i=[]],e=h;e<4*h+28;e++)o=r[e-1],(e%h===0||8===h&&e%h===4)&&(o=a[o>>>24]<<24^a[o>>16&255]<<16^a[o>>8&255]<<8^a[255&o],e%h===0&&(o=o<<8^o>>>24^l<<24,l=l<<1^283*(l>>7))),r[e]=r[e-h]^o;for(n=0;e;n++,e--)o=r[3&n?e:e-4],e<=4||n<4?i[n]=o:i[n]=c[0][a[o>>>24]]^c[1][a[o>>16&255]]^c[2][a[o>>8&255]]^c[3][a[255&o]]},s.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var t,e,n,o,r,i,s,a,c,h=this._tables[0],l=this._tables[1],d=h[4],u=l[4],p=[],_=[];for(t=0;t<256;t++)_[(p[t]=t<<1^283*(t>>7))^t]=t;for(e=n=0;!d[e];e^=o||1,n=_[n]||1)for(s=n^n<<1^n<<2^n<<3^n<<4,s=s>>8^255&s^99,d[e]=s,u[s]=e,i=p[r=p[o=p[e]]],c=16843009*i^65537*r^257*o^16843008*e,a=257*p[s]^16843008*s,t=0;t<4;t++)h[t][e]=a=a<<24^a>>>8,l[t][s]=c=c<<24^c>>>8;for(t=0;t<5;t++)h[t]=h[t].slice(0),l[t]=l[t].slice(0)},_crypt:function(t,e){if(4!==t.length)throw new s.exception.invalid("invalid aes block size");var n,o,r,i,a=this._key[e],c=t[0]^a[0],h=t[e?3:1]^a[1],l=t[2]^a[2],d=t[e?1:3]^a[3],u=a.length/4-2,p=4,_=[0,0,0,0],f=this._tables[e],y=f[0],m=f[1],v=f[2],g=f[3],b=f[4];for(i=0;i<u;i++)n=y[c>>>24]^m[h>>16&255]^v[l>>8&255]^g[255&d]^a[p],o=y[h>>>24]^m[l>>16&255]^v[d>>8&255]^g[255&c]^a[p+1],r=y[l>>>24]^m[d>>16&255]^v[c>>8&255]^g[255&h]^a[p+2],d=y[d>>>24]^m[c>>16&255]^v[h>>8&255]^g[255&l]^a[p+3],p+=4,c=n,h=o,l=r;for(i=0;i<4;i++)_[e?3&-i:i]=b[c>>>24]<<24^b[h>>16&255]<<16^b[l>>8&255]<<8^b[255&d]^a[p++],n=c,c=h,h=l,l=d,d=n;return _}},s.bitArray={bitSlice:function(t,e,n){return t=s.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),void 0===n?t:s.bitArray.clamp(t,n-e)},extract:function(t,e,n){var o,r=Math.floor(-e-n&31);return o=(e+n-1^e)&-32?t[e/32|0]<<32-r^t[e/32+1|0]>>>r:t[e/32|0]>>>r,o&(1<<n)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var n=t[t.length-1],o=s.bitArray.getPartial(n);return 32===o?t.concat(e):s.bitArray._shiftRight(e,o,0|n,t.slice(0,t.length-1))},bitLength:function(t){var e,n=t.length;return 0===n?0:(e=t[n-1],32*(n-1)+s.bitArray.getPartial(e))},clamp:function(t,e){if(32*t.length<e)return t;t=t.slice(0,Math.ceil(e/32));var n=t.length;return e&=31,n>0&&e&&(t[n-1]=s.bitArray.partial(e,t[n-1]&2147483648>>e-1,1)),t},partial:function(t,e,n){return 32===t?e:(n?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(s.bitArray.bitLength(t)!==s.bitArray.bitLength(e))return!1;var n,o=0;for(n=0;n<t.length;n++)o|=t[n]^e[n];return 0===o},_shiftRight:function(t,e,n,o){var r,i,a=0;for(void 0===o&&(o=[]);e>=32;e-=32)o.push(n),n=0;if(0===e)return o.concat(t);for(r=0;r<t.length;r++)o.push(n|t[r]>>>e),n=t[r]<<32-e;return a=t.length?t[t.length-1]:0,i=s.bitArray.getPartial(a),o.push(s.bitArray.partial(e+i&31,e+i>32?n:o.pop(),1)),o},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]}},s.codec.utf8String={fromBits:function(t){var e,n,o="",r=s.bitArray.bitLength(t);for(e=0;e<r/8;e++)0===(3&e)&&(n=t[e/4]),o+=String.fromCharCode(n>>>24),n<<=8;return decodeURIComponent(escape(o))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,n=[],o=0;for(e=0;e<t.length;e++)o=o<<8|t.charCodeAt(e),3===(3&e)&&(n.push(o),o=0);return 3&e&&n.push(s.bitArray.partial(8*(3&e),o)),n}},s.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,n){var o,r="",i=0,a=s.codec.base64._chars,c=0,h=s.bitArray.bitLength(t);for(n&&(a=a.substr(0,62)+"-_"),o=0;6*r.length<h;)r+=a.charAt((c^t[o]>>>i)>>>26),i<6?(c=t[o]<<6-i,i+=26,o++):(c<<=6,i-=6);for(;3&r.length&&!e;)r+="=";return r},toBits:function(t,e){t=t.replace(/\s|=/g,"");var n,o,r=[],i=0,a=s.codec.base64._chars,c=0;for(e&&(a=a.substr(0,62)+"-_"),n=0;n<t.length;n++){if(o=a.indexOf(t.charAt(n)),o<0)throw new s.exception.invalid("this isn't base64!");i>26?(i-=26,r.push(c^o>>>i),c=o<<32-i):(i+=6,c^=o<<32-i)}return 56&i&&r.push(s.bitArray.partial(56&i,c,1)),r}},s.codec.base64url={fromBits:function(t){return s.codec.base64.fromBits(t,1,1)},toBits:function(t){return s.codec.base64.toBits(t,1)}},s.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},s.hash.sha256.hash=function(t){return(new s.hash.sha256).update(t).finalize()},s.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=s.codec.utf8String.toBits(t));var e,n=this._buffer=s.bitArray.concat(this._buffer,t),o=this._length,r=this._length=o+s.bitArray.bitLength(t);for(e=512+o&-512;e<=r;e+=512)this._block(n.splice(0,16));return this},finalize:function(){var t,e=this._buffer,n=this._h;for(e=s.bitArray.concat(e,[s.bitArray.partial(1,1)]),t=e.length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),n},_init:[],_key:[],_precompute:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}var e,n=0,o=2;t:for(;n<64;o++){for(e=2;e*e<=o;e++)if(o%e===0)continue t;n<8&&(this._init[n]=t(Math.pow(o,.5))),this._key[n]=t(Math.pow(o,1/3)),n++}},_block:function(t){var e,n,o,r,i=t.slice(0),s=this._h,a=this._key,c=s[0],h=s[1],l=s[2],d=s[3],u=s[4],p=s[5],_=s[6],f=s[7];for(e=0;e<64;e++)e<16?n=i[e]:(o=i[e+1&15],r=i[e+14&15],n=i[15&e]=(o>>>7^o>>>18^o>>>3^o<<25^o<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+i[15&e]+i[e+9&15]|0),n=n+f+(u>>>6^u>>>11^u>>>25^u<<26^u<<21^u<<7)+(_^u&(p^_))+a[e],f=_,_=p,p=u,u=d+n|0,d=l,l=h,h=c,c=n+(h&l^d&(h^l))+(h>>>2^h>>>13^h>>>22^h<<30^h<<19^h<<10)|0;s[0]=s[0]+c|0,s[1]=s[1]+h|0,s[2]=s[2]+l|0,s[3]=s[3]+d|0,s[4]=s[4]+u|0,s[5]=s[5]+p|0,s[6]=s[6]+_|0,s[7]=s[7]+f|0}},s.prng=function(t){this._pools=[new s.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=t,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},s.prng.prototype={randomWords:function(t,e){var n,o,r=[],i=this.isReady(e);if(i===this._NOT_READY)throw new s.exception.notReady("generator isn't seeded");for(i&this._REQUIRES_RESEED&&this._reseedFromPools(!(i&this._READY)),n=0;n<t;n+=4)(n+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),o=this._gen4words(),r.push(o[0],o[1],o[2],o[3]);return this._gate(),r.slice(0,t)},setDefaultParanoia:function(t,e){if(0===t&&"Setting paranoia=0 will ruin your security; use it only for testing"!==e)throw"Setting paranoia=0 will ruin your security; use it only for testing";this._defaultParanoia=t},addEntropy:function(t,e,n){n=n||"user";var o,r,i,a,c=(new Date).valueOf(),h=this._robins[n],l=this.isReady(),d=0;switch(o=this._collectorIds[n],void 0===o&&(o=this._collectorIds[n]=this._collectorIdNext++),void 0===h&&(h=this._robins[n]=0),this._robins[n]=(this._robins[n]+1)%this._pools.length,typeof t){case"number":void 0===e&&(e=1),this._pools[h].update([o,this._eventId++,1,e,c,1,0|t]);break;case"object":if(a=Object.prototype.toString.call(t),"[object Uint32Array]"===a){for(i=[],r=0;r<t.length;r++)i.push(t[r]);t=i}else for("[object Array]"!==a&&(d=1),r=0;r<t.length&&!d;r++)"number"!=typeof t[r]&&(d=1);if(!d){if(void 0===e)for(e=0,r=0;r<t.length;r++)for(i=t[r];i>0;)e++,i>>>=1;this._pools[h].update([o,this._eventId++,2,e,c,t.length].concat(t))}break;case"string":void 0===e&&(e=t.length),this._pools[h].update([o,this._eventId++,3,e,c,t.length]),this._pools[h].update(t);break;default:d=1}if(d)throw new s.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[h]+=e,this._poolStrength+=e,l===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(t){var e=this._PARANOIA_LEVELS[void 0!==t?t:this._defaultParanoia];return this._strength&&this._strength>=e?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=e?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(t){var e=this._PARANOIA_LEVELS[t?t:this._defaultParanoia];return this._strength>=e?1:this._poolStrength>e?1:this._poolStrength/e},startCollectors:function(){if(!this._collectorsStarted){if(this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector)},window.addEventListener)window.addEventListener("load",this._eventListener.loadTimeCollector,!1),window.addEventListener("mousemove",this._eventListener.mouseCollector,!1),window.addEventListener("keypress",this._eventListener.keyboardCollector,!1),window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1);else{if(!document.attachEvent)throw new s.exception.bug("can't attach event");document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector),document.attachEvent("keypress",this._eventListener.keyboardCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._eventListener.loadTimeCollector,!1),window.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),window.removeEventListener("keypress",this._eventListener.keyboardCollector,!1),window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector),document.detachEvent("keypress",this._eventListener.keyboardCollector)),this._collectorsStarted=!1)},addEventListener:function(t,e){this._callbacks[t][this._callbackI++]=e},removeEventListener:function(t,e){var n,o,r=this._callbacks[t],i=[];for(o in r)r.hasOwnProperty(o)&&r[o]===e&&i.push(o);for(n=0;n<i.length;n++)o=i[n],delete r[o]},_bind:function(t){var e=this;return function(){t.apply(e,arguments)}},_gen4words:function(){for(var t=0;t<4&&(this._counter[t]=this._counter[t]+1|0,!this._counter[t]);t++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new s.cipher.aes(this._key)},_reseed:function(t){this._key=s.hash.sha256.hash(this._key.concat(t)),this._cipher=new s.cipher.aes(this._key);for(var e=0;e<4&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);},_reseedFromPools:function(t){var e,n=[],o=0;for(this._nextReseed=n[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,e=0;e<16;e++)n.push(4294967296*Math.random()|0);for(e=0;e<this._pools.length&&(n=n.concat(this._pools[e].finalize()),o+=this._poolEntropy[e],this._poolEntropy[e]=0,t||!(this._reseedCount&1<<e));e++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new s.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=o,o>this._strength&&(this._strength=o),this._reseedCount++,this._reseed(n)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(t){var e=t.x||t.clientX||t.offsetX||0,n=t.y||t.clientY||t.offsetY||0;s.random.addEntropy([e,n],2,"mouse"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(t){window&&window.performance&&"function"==typeof window.performance.now?s.random.addEntropy(window.performance.now(),t,"loadtime"):s.random.addEntropy((new Date).valueOf(),t,"loadtime")},_accelerometerCollector:function(t){var e=t.accelerationIncludingGravity.x||t.accelerationIncludingGravity.y||t.accelerationIncludingGravity.z;if(window.orientation){var n=window.orientation;"number"==typeof n&&s.random.addEntropy(n,1,"accelerometer")}e&&s.random.addEntropy(e,2,"accelerometer"),this._addCurrentTimeToEntropy(0)},_fireEvent:function(t,e){var n,o=s.random._callbacks[t],r=[];for(n in o)o.hasOwnProperty(n)&&r.push(o[n]);for(n=0;n<r.length;n++)r[n](e)}},s.random=new s.prng(6),function(){try{var t,e,n;if("undefined"!=typeof module&&module.exports&&(e=require("crypto"))&&e.randomBytes)t=e.randomBytes(128),t=new Uint32Array(new Uint8Array(t).buffer),s.random.addEntropy(t,1024,"crypto.randomBytes");else if(window&&Uint32Array){if(n=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(n);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)return;window.msCrypto.getRandomValues(n)}s.random.addEntropy(n,1024,"crypto.getRandomValues")}}catch(t){console.log("There was an error collecting entropy from the browser:"),console.log(t)}}()}).call(this);